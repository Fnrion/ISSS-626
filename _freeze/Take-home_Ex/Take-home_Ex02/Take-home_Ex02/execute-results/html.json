{
  "hash": "b4a77a898d92b824015e0f762b8eb4ea",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Take-home_Ex02\"\nauthor: \"Zou Jiaxun\"\ndate: \"Oct 2, 2024\"\ndata-modified: \"last-modified\"\nexecute: \n  eval: true\n  echo: true\n  warning: false\n  freeze: true\n  cache: true\nformat:\n  html:\n    code-fold: true\n    code-summary: \"Click to view code\"\n---\n\n\n\n# **1 Overview**\n\n## **1.1 Background**\n\nTourism is a critical pillar of Thailand’s economy, contributing around 20% of the country’s GDP. In 2019, the sector generated approximately 90 billion US dollars from both domestic and international tourism. However, the COVID-19 pandemic severely impacted the industry, reducing revenues to 24 billion US dollars in 2020. Since September 2021, tourism revenue has shown a steady recovery, as indicated by the data from January 2019 to February 2023. Despite this rebound, the benefits of the tourism economy are concentrated in a few key provinces—Bangkok, Phuket, Chiang Mai, Sukhothai, and Phetchaburi—highlighting an uneven distribution of tourism income across the country.\n\n## **1.2 Objectives**\n\n::: panel-tabset\n## Aim\n\nTest **tourism economy** of Thailand are **independent** from space and space and time or not.\n\nDetect where are the **clusters and outliers**, and the emerging **hot spot/cold spot areas**.\n\n## Test\n\nUsing appropriate function of **sf** and **tidyverse**, preparing the following geospatial data layer:\n\n-   a study area layer in sf polygon features. It must be at [province level](http://localhost:3980/Take-Home_Ex/Take-home_Ex02/Take-home_Ex02.html#0) (including Bangkok) of Thailand.\n\n-   a tourism economy indicators layer within the study area in sf polygon features.\n\n-   a derived tourism economy indicator layer in [**spacetime s3 class of sfdep**](http://localhost:3980/Take-Home_Ex/Take-home_Ex02/Take-home_Ex02.html#0). Keep the time series at **month and year levels**.\n\nUsing the extracted data, perform\n\n-   global spatial autocorrelation analysis\n\n-   local spatial autocorrelation analysis\n\n-   emerging hotspot analysis\n\nby using [sfdep methods](http://localhost:3980/Take-Home_Ex/Take-home_Ex02/Take-home_Ex02.html#0).\n\nDescribe the spatial patterns revealed by the analysis above.\n:::\n\n# **2 Data Wrangling**\n\n## **2.1 Loading Packages**\n\nThe following packages will be used for this exercise:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npacman::p_load(sf, spNetwork, tmap, tidyverse, dplyr,\n               spatstat, knitr, sfdep, spdep, ClustGeo,\n               ggpubr, cluster, factoextra, NbClust,\n               heatmaply, corrplot, psych, GGally)\n\npackage_info <- data.frame(\n  Package = c(\n    \"sf\", \"spNetwork\", \"tmap\", \"tidyverse\", \"dplyr\", \n    \"spatstat\", \"knitr\", \"sfdep\", \"spdep\", \"ClustGeo\", \n    \"ggpubr\", \"cluster\", \"factoextra\", \"NbClust\", \n    \"heatmaply\", \"corrplot\", \"psych\", \"GGally\"\n  ),\n  Description = c(\n    \"For importing, managing, and handling geospatial data\",\n    \"For network-based spatial analysis, including kernel density estimation on networks\",\n    \"For thematic mapping and interactive visualizations\",\n    \"For non-spatial data wrangling and general data analysis with a collection of packages\",\n    \"For data manipulation and pipeline tools, part of the tidyverse\",\n    \"For spatial statistics and point pattern analysis\",\n    \"For dynamic report generation using LaTeX, HTML, and Markdown\",\n    \"For spatial statistics with a focus on spatial dependence and spatial autoregressive models\",\n    \"For spatial dependence analysis in spatial econometrics, including spatial lag and error models\",\n    \"For clustering spatial data using hierarchical clustering and geographical constraints\",\n    \"For creating publication-ready plots\",\n    \"For performing various clustering algorithms and analysis\",\n    \"For visualizing and interpreting the results of multivariate data clustering\",\n    \"For determining the optimal number of clusters in a dataset using various indices\",\n    \"For creating interactive heatmaps and hierarchical clustering visualizations\",\n    \"For visualizing correlation matrices using various methods\",\n    \"For performing descriptive statistics, factor analysis, and psychometrics\",\n    \"For visualizing correlations, pair plots, and creating enhanced data analysis plots\"\n  )\n)\n\nknitr::kable(package_info, col.names = c(\"Package\", \"Description\"))\n```\n\n::: {.cell-output-display}\n\n\n|Package    |Description                                                                                     |\n|:----------|:-----------------------------------------------------------------------------------------------|\n|sf         |For importing, managing, and handling geospatial data                                           |\n|spNetwork  |For network-based spatial analysis, including kernel density estimation on networks             |\n|tmap       |For thematic mapping and interactive visualizations                                             |\n|tidyverse  |For non-spatial data wrangling and general data analysis with a collection of packages          |\n|dplyr      |For data manipulation and pipeline tools, part of the tidyverse                                 |\n|spatstat   |For spatial statistics and point pattern analysis                                               |\n|knitr      |For dynamic report generation using LaTeX, HTML, and Markdown                                   |\n|sfdep      |For spatial statistics with a focus on spatial dependence and spatial autoregressive models     |\n|spdep      |For spatial dependence analysis in spatial econometrics, including spatial lag and error models |\n|ClustGeo   |For clustering spatial data using hierarchical clustering and geographical constraints          |\n|ggpubr     |For creating publication-ready plots                                                            |\n|cluster    |For performing various clustering algorithms and analysis                                       |\n|factoextra |For visualizing and interpreting the results of multivariate data clustering                    |\n|NbClust    |For determining the optimal number of clusters in a dataset using various indices               |\n|heatmaply  |For creating interactive heatmaps and hierarchical clustering visualizations                    |\n|corrplot   |For visualizing correlation matrices using various methods                                      |\n|psych      |For performing descriptive statistics, factor analysis, and psychometrics                       |\n|GGally     |For visualizing correlations, pair plots, and creating enhanced data analysis plots             |\n\n\n:::\n:::\n\n\n\n## **2.2 The Data**\n\nThe following data are used for this study:\n\n-   Aspatial:\n\n    -   *Thailand Domestic Tourism Statistics* at Kaggle. Version 2 is required to do the data set.\n\n-   Geospatial:\n\n    -   *Thailand - Subnational Administrative Boundaries* at HDX.\n\n## 2.3 Import & Preparation\n\n::: panel-tabset\n## Aspatial\n\nWe will be importing the *Thailand domestic tourism from 2019 to 2023* by using the *read_csv()* or **readr** package, and check the repeat columns with the *duplicated()*\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntourism <- read_csv(\"data/aspatial/thailand_domestic_tourism_2019_2023_ver2.csv\")\nhead(tourism, 5)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 5 × 7\n  date       province_thai province_eng    region_thai region_eng variable value\n  <date>     <chr>         <chr>           <chr>       <chr>      <chr>    <dbl>\n1 2019-01-01 กรุงเทพมหานคร  Bangkok         ภาคกลาง     central    ratio_t…  93.4\n2 2019-01-01 ลพบุรี          Lopburi         ภาคกลาง     central    ratio_t…  61.3\n3 2019-01-01 พระนครศรีอยุธยา Phra Nakhon Si… ภาคกลาง     central    ratio_t…  73.4\n4 2019-01-01 สระบุรี         Saraburi        ภาคกลาง     central    ratio_t…  67.3\n5 2019-01-01 ชัยนาท         Chainat         ภาคกลาง     central    ratio_t…  79.3\n```\n\n\n:::\n\n```{.r .cell-code}\nany(duplicated(tourism))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] FALSE\n```\n\n\n:::\n:::\n\n\n\n-   There are 7 variables in the *tourism* data, they are:\n\n    -   ***Date***: The month and year when the statistics were recorded. The dataset spans the years 2019-2023\n\n    -   ***province_thai***: The name of the province in Thailand, in the Thai language\n\n    -   ***province_eng***: The name of the province in Thailand, in English\n\n    -   ***region_thai***: The name of the region in Thailand to which the province belongs, in the Thai language\n\n    -   ***region_eng***: The name of the region in Thailand to which the province belongs, in English\n\n    -   ***variable***: The 8 type of data being recorded, such as the number of tourists or the occupancy rate.\n\n    -   ***value***: The value of the data being recorded\n\n-   We also note that values in *variable*  are 8 different types of data that represent different occupancy rate.\n\n    -   ***no_tourist_all***: The total number of domestic tourists who visited the province\n\n    -   ***no_tourist_foreign***: The number of foreign tourists who visited the province\n\n    -   ***no_tourist_occupied***: The total number of occupied hotel rooms in the province\n\n    -   ***no_tourist_thai***: The number of Thai tourists who visited the province\n\n    -   ***occupancy_rate***: The percentage of occupied travel accommodation in the province\n\n    -   ***revenue_all***: The revenue generated by the tourism industry in the province, in Thai Baht\n\n    -   ***revenue_foreign***: The revenue generated by foreign tourists in the province, in Thai Baht\n\n    -   ***revenue_thai***: The revenue generated by Thai tourists in the province, in Thai Baht\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfiltered_tourism <- tourism %>%\n  select(date, province_eng, region_eng, variable, value) %>%\n  pivot_wider(names_from = variable, values_from = value) \nhead(filtered_tourism, 10)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 10 × 11\n   date       province_eng         region_eng ratio_tourist_stay no_tourist_stay\n   <date>     <chr>                <chr>                   <dbl>           <dbl>\n 1 2019-01-01 Bangkok              central                  93.4         3334971\n 2 2019-01-01 Lopburi              central                  61.3           51858\n 3 2019-01-01 Phra Nakhon Si Ayut… central                  73.4          117052\n 4 2019-01-01 Saraburi             central                  67.3           89850\n 5 2019-01-01 Chainat              central                  79.3           27141\n 6 2019-01-01 Nakhon Pathom        central                  71.7          118629\n 7 2019-01-01 Sing Buri            central                  64.6           18147\n 8 2019-01-01 Ang Thong            central                  71.2           19140\n 9 2019-01-01 Nonthaburi           central                  75.1          100553\n10 2019-01-01 Pathum Thani         central                  60.8           56118\n# ℹ 6 more variables: no_tourist_all <dbl>, no_tourist_thai <dbl>,\n#   no_tourist_foreign <dbl>, revenue_all <dbl>, revenue_thai <dbl>,\n#   revenue_foreign <dbl>\n```\n\n\n:::\n:::\n\n\n\n\n## Geospatial\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbd <- st_read(dsn = \"data/geospatial\", layer = \"tha_admbnda_adm2_rtsd_20220121\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nReading layer `tha_admbnda_adm2_rtsd_20220121' from data source \n  `/Applications/SMU/S3/ISSS626 - Geo/ISSS-626 ZOUJIAXUN/Take-home_Ex/Take-home_Ex02/data/geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 928 features and 19 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 97.34336 ymin: 5.613038 xmax: 105.637 ymax: 20.46507\nGeodetic CRS:  WGS 84\n```\n\n\n:::\n\n```{.r .cell-code}\nst_crs(bd)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nCoordinate Reference System:\n  User input: WGS 84 \n  wkt:\nGEOGCRS[\"WGS 84\",\n    DATUM[\"World Geodetic System 1984\",\n        ELLIPSOID[\"WGS 84\",6378137,298.257223563,\n            LENGTHUNIT[\"metre\",1]]],\n    PRIMEM[\"Greenwich\",0,\n        ANGLEUNIT[\"degree\",0.0174532925199433]],\n    CS[ellipsoidal,2],\n        AXIS[\"latitude\",north,\n            ORDER[1],\n            ANGLEUNIT[\"degree\",0.0174532925199433]],\n        AXIS[\"longitude\",east,\n            ORDER[2],\n            ANGLEUNIT[\"degree\",0.0174532925199433]],\n    ID[\"EPSG\",4326]]\n```\n\n\n:::\n\n```{.r .cell-code}\nbd <- st_transform(bd, crs = 32647)\nst_crs(bd)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nCoordinate Reference System:\n  User input: EPSG:32647 \n  wkt:\nPROJCRS[\"WGS 84 / UTM zone 47N\",\n    BASEGEOGCRS[\"WGS 84\",\n        ENSEMBLE[\"World Geodetic System 1984 ensemble\",\n            MEMBER[\"World Geodetic System 1984 (Transit)\"],\n            MEMBER[\"World Geodetic System 1984 (G730)\"],\n            MEMBER[\"World Geodetic System 1984 (G873)\"],\n            MEMBER[\"World Geodetic System 1984 (G1150)\"],\n            MEMBER[\"World Geodetic System 1984 (G1674)\"],\n            MEMBER[\"World Geodetic System 1984 (G1762)\"],\n            MEMBER[\"World Geodetic System 1984 (G2139)\"],\n            ELLIPSOID[\"WGS 84\",6378137,298.257223563,\n                LENGTHUNIT[\"metre\",1]],\n            ENSEMBLEACCURACY[2.0]],\n        PRIMEM[\"Greenwich\",0,\n            ANGLEUNIT[\"degree\",0.0174532925199433]],\n        ID[\"EPSG\",4326]],\n    CONVERSION[\"UTM zone 47N\",\n        METHOD[\"Transverse Mercator\",\n            ID[\"EPSG\",9807]],\n        PARAMETER[\"Latitude of natural origin\",0,\n            ANGLEUNIT[\"degree\",0.0174532925199433],\n            ID[\"EPSG\",8801]],\n        PARAMETER[\"Longitude of natural origin\",99,\n            ANGLEUNIT[\"degree\",0.0174532925199433],\n            ID[\"EPSG\",8802]],\n        PARAMETER[\"Scale factor at natural origin\",0.9996,\n            SCALEUNIT[\"unity\",1],\n            ID[\"EPSG\",8805]],\n        PARAMETER[\"False easting\",500000,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8806]],\n        PARAMETER[\"False northing\",0,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8807]]],\n    CS[Cartesian,2],\n        AXIS[\"(E)\",east,\n            ORDER[1],\n            LENGTHUNIT[\"metre\",1]],\n        AXIS[\"(N)\",north,\n            ORDER[2],\n            LENGTHUNIT[\"metre\",1]],\n    USAGE[\n        SCOPE[\"Engineering survey, topographic mapping.\"],\n        AREA[\"Between 96°E and 102°E, northern hemisphere between equator and 84°N, onshore and offshore. China. Indonesia. Laos. Malaysia - West Malaysia. Mongolia. Myanmar (Burma). Russian Federation. Thailand.\"],\n        BBOX[0,96,84,102]],\n    ID[\"EPSG\",32647]]\n```\n\n\n:::\n\n```{.r .cell-code}\nany(duplicated(bd))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] FALSE\n```\n\n\n:::\n\n```{.r .cell-code}\nbd_clean <- bd %>%\n  select(where(~ !all(is.na(.))))\n```\n:::\n\n\n:::\n\n# **3 Geospatial Analysis**\n\n## **3.1 if the key indicators of tourism economy of Thailand are independent from space and space and time.**\n\n# **4 Geovisualisation & Geocommunication**\n\n# **5 Reproducibility**\n\n# **6 Bonus**\n\n# **7 Reference**\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}